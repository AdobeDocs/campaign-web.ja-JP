---
audience: end-user
title: 「増分処理クエリ」ワークフローアクティビティを使用
description: 「増分処理クエリ」ワークフローアクティビティの使用方法を説明します
source-git-commit: 575219c7bcef303e211f504d13227183933924cc
workflow-type: tm+mt
source-wordcount: '743'
ht-degree: 25%

---

# 増分処理クエリ {#incremental-query}

>[!CONTEXTUALHELP]
>id="acw_orchestration_incrementalquery"
>title="増分処理クエリ"
>abstract="この **増分クエリ** アクティビティはです **ターゲティング** クエリモデラーを使用してデータベースに対してクエリを実行できるアクティビティ。 このアクティビティが実行されるたびに、以前の実行結果が除外されます。これにより、新しい要素だけをターゲットにすることができます。"

>[!CONTEXTUALHELP]
>id="acw_orchestration_incrementalquery_history"
>title="増分処理クエリ履歴"
>abstract="増分処理クエリ履歴"

この **増分クエリ** アクティビティはです **ターゲティング** スケジュールに従ってデータベースに対してクエリを実行できるアクティビティ。 このアクティビティが実行されるたびに、以前の実行結果が除外されます。これにより、新しい要素だけをターゲットにすることができます。

>[!NOTE]
>
>Campaign クライアントコンソールによって **[!UICONTROL 増分クエリ]** アクティビティ スケジューラーが組み込まれている Campaign web ユーザーインターフェイスでは、この機能が個別に処理されます。 増分処理クエリの実行をスケジュールするには、を追加する必要があります **[!UICONTROL スケジューラー]** 次より前のワークフロー内のアクティビティ **[!UICONTROL 増分クエリ]** アクティビティ。 [スケジューラーアクティビティの設定方法を学ぶ](scheduler.md)

この **[!UICONTROL 増分クエリ]** アクティビティは、次のような様々なタイプの用途に使用できます。

* 個人をセグメント化して、メッセージやオーディエンスなどのターゲットを定義する。
* データをエクスポートしています。 例えば、アクティビティを使用して、ファイルに新しいログを定期的に書き出すことができます。 外部のレポートや BI ツールでログデータを使用する場合に役立ちます。

以前の実行で既にターゲットになっている母集団は、ワークフローに保存されます。 つまり、同じテンプレートから開始された 2 つのワークフローは同じログを共有しません。 ただし、同じワークフロー内の同じ増分クエリに基づく 2 つのタスクでは、同じログを使用します。

増分処理クエリの実行中にその結果が 0 になった場合、クエリの次にプログラムされた実行までワークフローは一時停止します。 このため、増分処理クエリに続くトランザクションとアクティビティが、次回の実行前に処理されることはありません。

## 「増分処理クエリ」アクティビティを設定します {#incremental-query-configuration}

次の手順に従って、 **増分クエリ** アクティビティ：

![](../assets/incremental-query.png)

1. を追加 **増分クエリ** ワークフローへのアクティビティ。

1. が含まれる **[!UICONTROL 対象読者]** セクションで、 **ターゲティングディメンション** 次に、 **[!UICONTROL 続行]**.

   ターゲティングディメンションは、受信者、契約の受益者、オペレーター、サブスクライバーなど、ターゲットされる母集団を操作ごとに定義します。デフォルトでは、ターゲットが受信者から選択されます。[ターゲティングディメンションについての詳細を学ぶ](../../audience/about-recipients.md#targeting-dimensions)

1. 新しいメールをデザインする際にオーディエンスを作成するのと同じ方法で、クエリモデラーを使用してクエリを定義します。[クエリモデラーの操作方法の詳細を学ぶ](../../query/query-modeler-overview.md)

1. が含まれる **[!UICONTROL 処理済みデータ]** セクションで、使用する増分モードを選択します。

   * **[!UICONTROL 以前の実行結果を除外]**：アクティビティを実行するたびに、前回の実行結果が除外されます。

     以前の実行で既にターゲット設定されたレコードは、ターゲット設定された日からの最大日数でログ記録できます。 これを行うには、 **[!UICONTROL 履歴（日数）]** フィールド。 値がゼロの場合、受信者がログからパージされることはありません。

   * **[!UICONTROL 日付フィールドを使用]**：このオプションを使用すると、特定の日付フィールドに基づいて、以前の実行の結果を除外できます。 それには、選択したターゲティングディメンションで使用できる属性のリストから目的の日付フィールドを選択します。 ワークフローの次回の実行時には、最後の実行日以降に変更または作成されたデータのみが取得されます。

     ワークフローを最初に実行した後、 **[!UICONTROL 最終実行日]** フィールドが使用可能になります。 次の実行に使用する日付を指定し、ワークフローを実行するたびに自動的に更新されます。 それでも、必要に応じて手動で別の値を入力すれば、この値を上書きすることはできます。

   >[!NOTE]
   >
   >この **[!UICONTROL 日付フィールドを使用]** モードを使用すると、選択した日付フィールドによってより柔軟に対応できます。 例えば、指定したフィールドが変更日に対応している場合、日付フィールドモードでは、最近更新されたデータを取得できます。一方、他のモードでは、ワークフローの最後の実行以降に変更された場合でも、以前の実行で既にターゲットになっていた録画を除外するだけです。

## 例 {#incremental-query-example}

次の例は、Yoga ニュースレターサービスを購読しているAdobe Campaign データベース内のプロファイルを毎週フィルタリングし、お知らせメールを送信するワークフローの設定を示しています。

![](../assets/incremental-query-example.png)

ワークフローは、次の要素で構成されています。

* A **[!UICONTROL スケジューラー]** アクティビティ：毎週月曜日の午前 6 時にワークフローを実行します。
* An **[!UICONTROL 増分クエリ]** アクティビティ。最初の実行時には現在のサブスクライバーをすべてターゲットにし、それ以降の実行時にはその週の新しいサブスクライバーのみをターゲットにします。
* An **[!UICONTROL メール配信]** アクティビティ。
