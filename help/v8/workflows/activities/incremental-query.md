---
audience: end-user
title: 増分クエリワークフローアクティビティの使用
description: 増分クエリワークフローアクティビティの使用方法を学ぶ
exl-id: 72bd307b-eba2-42a0-9744-05e089c34925
source-git-commit: b9f3deb579cf786e0eafa57f42a728b3f7a002d1
workflow-type: tm+mt
source-wordcount: '716'
ht-degree: 35%

---

# 増分クエリ {#incremental-query}

>[!CONTEXTUALHELP]
>id="acw_orchestration_incrementalquery"
>title="増分クエリ"
>abstract="**増分クエリ**&#x200B;アクティビティとは、クエリモデラーを使用してデータベースでクエリを実行できる&#x200B;**ターゲティング**&#x200B;アクティビティを意味します。このアクティビティが実行されるたびに、以前の実行結果が除外されます。これにより、新しい要素だけをターゲットにすることができます。"

>[!CONTEXTUALHELP]
>id="acw_orchestration_incrementalquery_history"
>title="増分処理クエリ履歴"
>abstract="増分処理クエリ履歴"

>[!CONTEXTUALHELP]
>id="acw_orchestration_incrementalquery_processeddata"
>title="増分クエリの処理済みデータ"
>abstract="増分クエリの処理済みデータ"

**増分処理クエリ** アクティビティは、スケジュールに従ってデータベースに対してクエリを実行できる **ターゲティング** アクティビティです。 このアクティビティが実行されるたびに、以前の実行結果が除外されます。これにより、新しい要素のみをターゲットにすることができます。

>[!NOTE]
>
>Campaign クライアントコンソールでは、**[!UICONTROL 増分クエリ]**&#x200B;アクティビティがビルトインのスケジューラーと統合されている一方、Campaign Web ユーザーインターフェイスではこの機能が個別に扱われます。増分処理クエリの実行をスケジュールするには、ワークフローの **[!UICONTROL スケジューラー]** アクティビティを **[!UICONTROL 増分処理クエリ]** アクティビティの前に追加します。 [スケジューラーアクティビティの設定方法を学ぶ](scheduler.md)

**[!UICONTROL 増分処理クエリ]** アクティビティは、様々な目的で使用できます。

* 個人をセグメント化して、メッセージ、オーディエンス、またはその他の操作のターゲットを定義します。
* データをエクスポートする。例えば、アクティビティを使用して、ファイルに新しいログを定期的にエクスポートします。 これは、外部レポートやビジネスインテリジェンスツールで役立ちます。

以前の実行で既にターゲットになっている母集団は、ワークフローに保存されます。同じテンプレートから開始された 2 つのワークフローは、同じログを共有しません。 一方、同じワークフローの同じ増分クエリに基づく 2 つのタスクは、同じログを使用します。

増分処理クエリの結果が、いずれかの実行時に 0 に等しい場合、ワークフローは、クエリの次のプログラムされた実行まで一時停止します。 増分処理クエリの後に続くトランジションとアクティビティは、次の実行の前には処理されません。

## 増分クエリアクティビティの設定 {#incremental-query-configuration}

**増分クエリ**&#x200B;アクティビティを設定するには、次の手順に従います。

[ 説明：Adobe Campaignの増分処理クエリアクティビティの設定インターフェイスを示すスクリーンショット。]\
![](../assets/incremental-query.png)

1. ワークフローに&#x200B;**増分クエリ**&#x200B;アクティビティを追加します。

1. 「**[!UICONTROL オーディエンス]**」セクションで、「**ターゲティングディメンション** を選択し、「**[!UICONTROL 続行]**」をクリックします。

   ターゲティングディメンションは、受信者、契約の受益者、オペレーター、サブスクライバーなど、操作のターゲットになる母集団を定義します。 デフォルトでは、ターゲットが受信者から選択されます。[ターゲティングディメンションについての詳細を学ぶ](../../audience/about-recipients.md#targeting-dimensions)

1. クエリモデラーを使用して、新しいメールをデザインする際にオーディエンスを作成する方法と同様に、クエリを定義します。 [詳しくは、クエリモデラーの操作方法を参照してください。](../../query/query-modeler-overview.md)

1. 「**[!UICONTROL 処理済みのデータ]**」セクションで、使用する増分モードを選択します。

   * **[!UICONTROL 以前の実行結果を除外]**：アクティビティを実行するたびに、前回の実行結果が除外されます。

     以前の実行で既にターゲット設定されたレコードは、ターゲット設定された日から最長の日数、ログ記録できます。 この値を設定するには、「**[!UICONTROL 履歴（日数]**」フィールドを使用します。 値がゼロの場合、受信者がログからパージされることはありません。

   * **[!UICONTROL 日付フィールドを使用]**：このオプションでは、特定の日付フィールドに基づいて以前に実行した結果が除外されます。 選択したターゲティングディメンションで使用可能な属性のリストから目的の日付フィールドを選択します。 それ以降のワークフローの実行時には、最後の実行日以降に変更または作成されたデータのみが取得されます。

     ワークフローを最初に実行した後、「**[!UICONTROL 最終実行日]**」フィールドが使用可能になります。次の実行に使用する日付を指定し、ワークフローを実行するたびに自動的に更新されます。 この値は、必要に応じて手動で上書きできます。

   >[!NOTE]
   >
   >**[!UICONTROL 日付フィールドを使用]** モードでは、選択した日付フィールドによってより柔軟性が高くなります。 例えば、指定したフィールドが変更日に対応する場合、日付フィールドモードは最近更新されたデータを取得します。 もう 1 つのモードでは、前回のワークフローの実行以降に変更された場合でも、前回の実行で既にターゲットとなった録画が除外されます。

## 例 {#incremental-query-example}

次の例は、Adobe Campaign データベース内のプロファイルを毎週フィルタリングするワークフローの設定を示しています。 Yoga ニュースレターサービスを購読している個人をターゲットにし、お知らせメールを送信します。

![Yoga ニュースレターサービスを購読しているプロファイルをフィルタリングするためのワークフロー設定の例のスクリーンショット ](../assets/incremental-query-example.png)

ワークフローには、次の要素が含まれます。

* ワークフローを毎週月曜日の午前 6 時に実行する **[!UICONTROL スケジューラー]** アクティビティ。
* **[!UICONTROL 増分処理クエリ]** アクティビティ。最初の実行時は現在のすべてのサブスクライバーをターゲットにし、後続の実行時は新しいサブスクライバーのみをターゲットにします。
* **[!UICONTROL メール配信]**&#x200B;アクティビティ